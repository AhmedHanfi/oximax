{% extends 'base.html.twig' %}

{% block title %}Diagnostic{% endblock %}

{% block body %}
    <h1>Fiche diagnostic</h1>
    <div class="mb-4"></div>

    <h3>Dernière mise à jour</h3>
    <table class="table">
        <tbody>
            <tr>
                <th>Maladie</th>
                <td>{{ diagnostic.maladie }}</td>
            </tr>
            <tr>
                <th>Date de mise à jour</th>
                <td>{{ diagnostic.dateCreaction | date('d/m/Y H:i') }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ diagnostic.description }}</td>
            </tr>
            <tr>
                <th>Prescription</th>
                <td>{{ diagnostic.prescription }}</td>
            </tr>
            <tr>
                <th>Etat</th>
                <td>{{ diagnostic.etat }}</td>
            </tr>
            <tr>
                <th>Patient</th>
                {#  <td>{{ diagnostic.patient?(diagnostic.patient.prenom ~ ' ' ~ diagnostic.patient.nom ~ ' (' ~ diagnostic.patient.mail ~ ')'):'N/A' }}</td> #}
                <td>
                    {% if diagnostic.patient %}
                        <a href="{{ path('app_patient_show', {'id': diagnostic.patient.id}) }}">
                            {{ diagnostic.patient.nom }} ({{ diagnostic.patient.mail }})
                        </a>
                    {% else %}
                        N/A
                    {% endif %}
                </td>
            </tr>
        </tbody>
    </table>

    <div class="mb-4"></div>

    {% if diagnostic.HistoriqueDiagnostics is not empty %}
        <h3>{{ diagnostic.HistoriqueDiagnostics? 'Historique' : '' }}</h3>

        {% for HistoriqueDiagnostic in diagnostic.HistoriqueDiagnostics | reverse %}
            <table class="table table-borderless">
                <tbody>
                <tr>
                    <th>Maladie</th>
                    <td>{{ HistoriqueDiagnostic.maladie }}</td>
                </tr>
                <tr>
                    <th>Date de mise à jour</th>
                    <td>{{ HistoriqueDiagnostic.dateEdit | date('d/m/Y H:i') }}</td>
                </tr>
                <tr>
                    <th>Description</th>
                    <td>{{ HistoriqueDiagnostic.description }}</td>
                </tr>
                <tr>
                    <th>Prescription</th>
                    <td>{{ HistoriqueDiagnostic.prescription }}</td>
                </tr>
                <tr>
                    <th>Etat</th>
                    <td>{{ HistoriqueDiagnostic.etat }}</td>
                </tr>

                </tbody>
            </table>

            <hr/>
        {% endfor %}
    {% endif %}

    <button type="button" class="btn btn-outline-warning" onclick="goBack()">Retour</button>
    <script>
        function goBack() {
            window.history.back();
        }
    </script>


    <a class="btn btn-outline-success" href="{{ path('app_diagnostic_edit', {'id': diagnostic.id}) }}">Editer</a>

    {{ include('diagnostic/_delete_form.html.twig') }}
{% endblock %}
