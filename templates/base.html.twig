<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>
			{% block title %}Oxymax{% endblock %}
		</title>
		<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
		<link
		rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text></svg>">
		{# Run `composer require symfony/webpack-encore-bundle` to start using Symfony UX #}
		{% block stylesheets %}
			{{ encore_entry_link_tags('app') }}
		{% endblock %}
		{% block costumStylesheets %}
			<style>
				.dropdown-menu.show {
					position: absolute;
					top: 60px;
				}

				.dropdown-toggle {
					color: black;
					margin-right: .5rem;
					&:hover {
					 color: #555 !important;
				 }
				}

				.dropdown-menu > ul {
					list-style: none;
				}

				.dropdown-menu > ul > li {
					margin-left: -1rem;
					color: black;

				}

				.dropdown-menu > ul > li > a {
					text-decoration: none;
					color: black;

					&:hover {
						color: #999;
					  }
				}

				.dataTables_filter input {
					border-radius: 5px !important;
				}
			</style>
		{% endblock %}

		{% block javascripts %}
			{{ encore_entry_script_tags('app') }}

			<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
			<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>

		{% endblock %}
	</head>
	<body>

		{% block navBar %}
			<nav class="navbar d-flex px-3">
				<a class="navbar-brand" href="/">
					<img height="35" style="mix-blend-mode: difference;" src="{{ asset('build/images/logo.webp') }}" alt="Doctor Image">

				</a>
				<ul class="navbar-nav flex-row">
					{% if app.user %}
						<li class="nav-item p-2 mr-auto row d-flex align-items-center">

							<div class="dropdown">
								<li class="nav-item dropdown-toggle my-auto" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									Actions
								</li>
								<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
									{% if is_granted('ROLE_ADMIN') %}
										<ul>
											<li><a href="{{ path('app_user_index') }}">Gérer admins</a> </li>
											<li><a href="{{ path('app_responsable_index') }}">Gérer responsables</a> </li>
											<li><a href="{{ path('app_acceuil_index') }}">Gérer Accueils</a> </li>
											<li><a href="{{ path('app_docteur_index') }}">Gérer docteurs</a> </li>
											<li><a href="{{ path('app_patient_index') }}">Gérer patients</a> </li>

										</ul>
									{% endif %}
									{% if is_granted('ROLE_RESPONSABLE') %}
										{% include 'responsable/page_responsable.html.twig' %}
									{% endif %}
									{% if is_granted('ROLE_DOCTOR') %}
										{% include 'docteur/page_docteur.html.twig' %}
									{% endif %}
									{% if is_granted('ROLE_ACCEUIL') %}
										{% include 'acceuil/page_acceuil.html.twig' %}
									{% endif %}
								</div>
							</div>
						</li>

						<li class="nav-item p-2 mr-0 ml-auto">
							<a class="nav-link" href="{{ path('app_logout') }}">Se déconnecter</a>
						</li>
						{% else %}
							<li class="nav-item mr-0 ml-auto">
								<a class="nav-link" href="{{ path('app_login') }}">Se connecter</a>
							</li>
					{% endif %}
				</ul>
			</nav>
		{% endblock %}

		<div class="body-content">

			{% for label, messages in app.session.flashbag.all() %}
				{% for message in messages %}
					<div class="mt-2 alert alert-{{ label }}">
						{{ message|trans }}
					</div>
				{% endfor %}
			{% endfor %}
			{# {% if app.user %}
				<h3>Welcome, {{ app.user.username }}!</h3>

				{% if app.user.getDocteur %}
					<table class="table">
						<thead>
							<tr>
							<th scope="col">Nom</th>
							<th scope="col">Prenom</th>
							<th scope="col">mail</th>
							<th scope="col">Role</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>{{ app.user.getDocteur.prenom }}</td>
								<td>{{ app.user.getDocteur.nom }}</td>
								<td>{{ app.user.getDocteur.mail }}</td>
								<td>{{ app.user.roles[0] }}</td>
							</tr>
						</tbody>
					</table>
				{% endif %}


			{% endif %} #}
				
			{% block body %}

				{% if is_granted('ROLE_ADMIN') %}
					<ul>
						<li><a href="{{ path('app_user_index') }}">Gérer admins</a> </li>
						<li><a href="{{ path('app_responsable_index') }}">Gérer responsables</a> </li>
						<li><a href="{{ path('app_acceuil_index') }}">Gérer Accueils</a> </li>
						<li><a href="{{ path('app_docteur_index') }}">Gérer docteurs</a> </li>
						<li><a href="{{ path('app_patient_index') }}">Gérer patients</a> </li>

					</ul>
				{% endif %}
				{% if is_granted('ROLE_RESPONSABLE') %}
					{% include 'responsable/page_responsable.html.twig' %}	
				{% endif %}
				{% if is_granted('ROLE_DOCTOR') %}
					{% include 'docteur/page_docteur.html.twig' %}	
				{% endif %}
				{% if is_granted('ROLE_ACCEUIL') %}
					{% include 'acceuil/page_acceuil.html.twig' %}	
				{% endif %}

				
			{% endblock %}
		</div>
		
		<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
		<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
		<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
		<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
		<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
		<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>
		<script>
			$(document).ready(function() {
				$('#datatable').DataTable({
					dom: 'Bfrtip',
					buttons: [
						{ extend: 'copy', text: 'Copier', className: 'btn btn-primary' },
						{ extend: 'csv', text: 'CSV', className: 'btn btn-success' },
						{ extend: 'excel', text: 'Excel', className: 'btn btn-warning' },
						{ extend: 'pdf', text: 'PDF', className: 'btn btn-danger' },
						{ extend: 'print', text: 'Imprimer', className: 'btn btn-outline-primary' }
					],
					scrollX: true,
					columnDefs: [
						{ targets: '_all', width: 'auto' } // Set a fixed width for all columns
					],
					language: {
						search: "Recherche", // Change the search input text
						buttons: {
							copyTitle: 'Copier dans le presse-papiers',
							copySuccess: {
								_: '%d lignes copiées',
								1: '1 ligne copiée'
							}
						}
					},
					initComplete: function() {
					this.api().columns()
					},
				});
			});

		</script>
	</body>
</html>
